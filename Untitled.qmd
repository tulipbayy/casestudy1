---
title: "Election results in 2000"
author: "Bayansulu Tulepbayeva and Alua Birgebayeva"
date: "Case Study 1: March 5, 2025"
format: 
  pdf:
    keep-tex: true
    include-in-header: 
       text: |
         \usepackage{fvextra}
         \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
         \DefineVerbatimEnvironment{OutputCode}{Verbatim}{breaklines,commandchars=\\\{\}}
    geometry: 
      - left=1in
      - right=1in
      - top=1in
      - bottom=1in
---

## Introduction


## Data & Methodology

We analyzed 67 Florida counties using data from the Sleuth2 package. Since Palm Beach County is suspected to be an outlier, we excluded it from our regression model to avoid bias.

To estimate how many votes Buchanan should have received in Palm Beach, we built a linear regression model predicting Buchanan votes based on Bush votes in the other counties. The equation of our model is:
```{r}
#| include: false

# Loading necessary packages
library(tidyverse)
library(Sleuth2)      # the package containing the data for the case study
library(kableExtra)   # for creating nicely formatted tables in Quarto

# Loading the case study data
election <- Sleuth2::ex0825

# Creating a second dataset with Palm Beach County excluded
election_wo_pb <- election |> filter(County != "Palm Beach")

```

## Regression Model Results

To estimate the expected number of **Buchanan votes** in a county based on **Bush votes**, we use a **simple linear regression model**. This model predicts the mean number of Buchanan votes in a county, given the number of Bush votes.

### Mathematical Description of the Model

Let $(\text{Buchanan}_i)$ represent the number of votes for **Pat Buchanan** in county $(i)$, and let $(\text{Bush}_i)$ represent the number of votes for **George W. Bush** in county $(i)$.

Our **final population model for the mean** is:

$$
E[\text{Buchanan}_i \mid \text{Bush}_i] = \beta_0 + \beta_1 \text{Bush}_i
$$

where:

- $(\beta_0)$ is the **intercept**, representing the expected Buchanan votes when Bush votes are **zero**.

- $(\beta_1)$ is the **slope**, representing the expected **change in Buchanan votes** for each additional Bush vote.

### Fitted Regression Model

Using data from **66 Florida counties (excluding Palm Beach County)**, we estimated the model parameters:

$$
\hat{\text{Buchanan}}_i = 65.57 + 0.003482 \times \text{Bush}_i
$$

This means that for every additional **1,000 votes** for Bush, Buchananâ€™s expected vote count **increases by approximately 3.48 votes**.

### Regression Coefficients Table


```{r}
#| include: false
#| echo: false
#| message: false
#| warning: false

# Fit the linear model
model <- lm(Buchanan2000 ~ Bush2000, data = election_wo_pb)

# Display regression summary
summary(model)

```

```{r}
#| echo: false
# Format and display the regression summary in a clean table
library(kableExtra)

# Extract regression coefficients
regression_table <- summary(model)$coefficients |> 
  kbl(col.names = c("Estimate", "Std. Error", "t value", "Pr(>|t|)"), 
      align = "c", booktabs = TRUE) |> 
  kable_classic(full_width = FALSE, latex_options = c("HOLD_position"))

# Show the table
regression_table

```

Key findings:

- Even in a county with 0 Bush votes, Buchanan is expected to receive around 66 votes (Intercept). 

- Buchanan votes increase by ~3.48 for every 1,000 additional Bush votes (Slope).

- About 75% of the variation in Buchanan votes is explained by Bush votes, showing a strong correlation.

- The relationship between Buchanan and Bush votes is highly statistically significant.

## Prediction for Palm Beach County 

```{r}
# Get Bush votes in Palm Beach County
pb_bush_votes <- election |> filter(County == "Palm Beach") |> pull(Bush2000)

# Predict Buchanan votes for Palm Beach (95% prediction interval)
predicted_pb_buchanan <- predict(model, newdata = data.frame(Bush2000 = pb_bush_votes), interval = "prediction", level = 0.95)

# Show the prediction interval
predicted_pb_buchanan

predicted_pb_df <- data.frame(
  County = "Palm Beach",
  Predicted_Buchanan_Votes = predicted_pb_buchanan[1],
  Lower_Bound = predicted_pb_buchanan[2],
  Upper_Bound = predicted_pb_buchanan[3]
)

predicted_pb_df |> 
  kbl(col.names = c("County", "Predicted Buchanan Votes", "Lower Bound (95% CI)", "Upper Bound (95% CI)"), 
      align = "c", booktabs = TRUE) |> 
  kable_classic(full_width = FALSE, latex_options = c("HOLD_position"))

```

## Actual vs. Predicted Votes & Miscast Estimate

```{r}
# Get actual Buchanan votes in Palm Beach
actual_pb_buchanan <- election |> filter(County == "Palm Beach") |> pull(Buchanan2000)

# Print actual Buchanan votes
actual_pb_buchanan

```

## Estimating the Midcast votes 

```{r}
# Estimate miscast votes (Actual Buchanan votes - Upper Bound of Prediction Interval)
miscast_votes <- actual_pb_buchanan - predicted_pb_buchanan[3]

# Print estimated miscast votes
miscast_votes

```
 
 
## Results 

```{r}
# Create a summary table for the report
miscast_summary_df <- data.frame(
  County = "Palm Beach",
  Actual_Buchanan_Votes = actual_pb_buchanan,
  Predicted_Upper_Bound = predicted_pb_buchanan[3],
  Estimated_Miscast_Votes = miscast_votes
)

# Display as a well-formatted table
library(kableExtra)
miscast_summary_df |> 
  kbl(col.names = c("County", "Actual Buchanan Votes", "Upper Bound Prediction", "Estimated Miscast Votes"), 
      align = "c", booktabs = TRUE) |> 
  kable_classic(full_width = FALSE, latex_options = c("HOLD_position"))

```


# R Appendix

_Copy and paste all code that you used for your case study into one chunk at the end of your written report. Before submitting your case study, take one final look at the R Appendix and make sure that all code is clearly visible. If you see a line running off the side of the PDF, please split the code over multiple lines using a linebreak. The header at the top of this template should ensure that lines of code are automatically wrapped in your final document._

```{r}
#| message: FALSE
#| warning: FALSE


```
